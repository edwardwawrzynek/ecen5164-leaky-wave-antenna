close all; clc; clear

m = readmatrix("dispersion - Sheet2 (4).csv")
m1 = m(1:31, :)
m2 = m(32:63, :)
m3 = m(64:95, :)

figure(1)
hold on
plot(m1(:,1), m1(:,2), 'b')
plot(m1(:,1), m1(:,3), 'r')
plot(m1(:,1), m1(:,4), 'g')
plot(3.1:0.1:6.1, flip(m1(:,2)), 'b')
plot(3.1:0.1:6.1, flip(m1(:,3)), 'r')
plot(3.1:0.1:6.1, flip(m1(:,4)), 'g')

plot(m1(:,1)-2*pi, m1(:,2), 'b')
plot(m1(:,1)-2*pi, m1(:,3), 'r')
plot(m1(:,1)-2*pi, m1(:,4), 'g')
plot((3.1:0.1:6.1)-2*pi, flip(m1(:,2)), 'b')
plot((3.1:0.1:6.1)-2*pi, flip(m1(:,3)), 'r')
plot((3.1:0.1:6.1)-2*pi, flip(m1(:,4)), 'g')

plot(m1(:,1)+2*pi, m1(:,2), 'b')
plot(m1(:,1)+2*pi, m1(:,3), 'r')
plot(m1(:,1)+2*pi, m1(:,4), 'g')
plot((3.1:0.1:6.1)+2*pi, flip(m1(:,2)), 'b')
plot((3.1:0.1:6.1)+2*pi, flip(m1(:,3)), 'r')
plot((3.1:0.1:6.1)+2*pi, flip(m1(:,4)), 'g')

plot(m2(:,1), m2(:,2), 'b')
plot(m2(:,1), m2(:,3), 'r')
plot(m2(:,1), m2(:,4), 'g')
plot(0:0.1:3.2, [flip(m2(:,2)); 2.1315], 'b')
plot(0:0.1:3.2, [flip(m2(:,3)); 2.4397], 'r')
plot(0:0.1:3.2, [flip(m2(:,4)); 2.2995], 'g')

plot(m2(:,1)-2*pi, m2(:,2), 'b')
plot(m2(:,1)-2*pi, m2(:,3), 'r')
plot(m2(:,1)-2*pi, m2(:,4), 'g')
plot((0:0.1:3.2)-2*pi, [flip(m2(:,2)); 2.1315], 'b')
plot((0:0.1:3.2)-2*pi, [flip(m2(:,3)); 2.4397], 'r')
plot((0:0.1:3.2)-2*pi, [flip(m2(:,4)); 2.2995], 'g')

plot(m2(:,1)+2*pi, m2(:,2), 'b')
plot(m2(:,1)+2*pi, m2(:,3), 'r')
plot(m2(:,1)+2*pi, m2(:,4), 'g')
plot((0:0.1:3.2)+2*pi, [flip(m2(:,2)); 2.1315], 'b')
plot((0:0.1:3.2)+2*pi, [flip(m2(:,3)); 2.4397], 'r')
plot((0:0.1:3.2)+2*pi, [flip(m2(:,4)); 2.2995], 'g')

plot(m3(:,1), m3(:,2), 'b')
plot(m3(:,1), m3(:,3), 'r')
plot(m3(:,1), m3(:,4), 'g')
plot(9.4:0.1:12.6, [flip(m3(:,2));4.0144], 'b')
plot(9.4:0.1:12.6, [flip(m3(:,3));4.4822], 'r')
plot(9.4:0.1:12.6, [flip(m3(:,4));4.2013], 'g')

plot(m3(:,1)-2*pi, m3(:,2), 'b')
plot(m3(:,1)-2*pi, m3(:,3), 'r')
plot(m3(:,1)-2*pi, m3(:,4), 'g')
plot((9.4:0.1:12.6)-2*pi, [flip(m3(:,2));4.0144], 'b')
plot((9.4:0.1:12.6)-2*pi, [flip(m3(:,3));4.4822], 'r')
plot((9.4:0.1:12.6)-2*pi, [flip(m3(:,4));4.2013], 'g')


plot(m3(:,1)-4*pi, m3(:,2), 'b')
plot(m3(:,1)-4*pi, m3(:,3), 'r')
plot(m3(:,1)-4*pi, m3(:,4), 'g')
plot((9.4:0.1:12.6)-4*pi, [flip(m3(:,2));4.0144], 'b')
plot((9.4:0.1:12.6)-4*pi, [flip(m3(:,3));4.4822], 'r')
plot((9.4:0.1:12.6)-4*pi, [flip(m3(:,4));4.2013], 'g')

title("Dispersion with Average Surface Reactance X=1.2")
ylabel('k_0a')
xlabel('\kappa a')
legend('M=0.2','M=0.8','M=0.5') 
